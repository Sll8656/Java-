# 软件开发整体介绍
## 软件开发流程

- 需求分析（产品原型、需求规格说明书）
- 设计（产品文档、UI界面设计、数据库设计）
- 编码（项目代码、单元测试）
- 测试（测试用例、测试报告）
- 上线运维（软件环境安装、配置）
## 角色分工

- 项目经理：对整个项目负责，任务分配、把控进度
- 产品经理：需求调研，需求文档、产品原型
- UI设计师：根据产品原型输出**界面效果图**
- 架构师：项目整体架构设计、技术选型等
- 工程师
   - 开发：代码实现
   - 测试：编写测试用例，写测试报告
   - 运维：软件环境搭建、项目上线
## 软件环境

- 开发环境：开发阶段使用，外部用户无法访问
- 测试环境：测试人员使用，外部用户无法访问
- 生成环境：线上环境，对外服务环境

# 项目介绍
## 功能架构：
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688553629994-8f976a16-a9cd-40b3-8b62-d2ff58f7ddca.png#averageHue=%23fbfbf9&clientId=uf2ee8ceb-c611-4&from=paste&height=597&id=u0054ecad&originHeight=1193&originWidth=1976&originalType=binary&ratio=2&rotation=0&showTitle=false&size=504414&status=done&style=none&taskId=uad2db96b-171d-4ddc-b596-099449305f6&title=&width=988)
## 技术选型：
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688553579240-7881ded1-4868-4a10-9097-d49f9d24fa87.png#averageHue=%23fefefc&clientId=udd8b68b7-3d42-4&from=paste&height=683&id=uf541e71d&originHeight=1365&originWidth=2872&originalType=binary&ratio=2&rotation=0&showTitle=false&size=551437&status=done&style=none&taskId=ud8f832f4-6058-4d58-8634-0fde6befa9b&title=&width=1436)

# 开发环境搭建
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688554298290-8a47d3eb-1868-4441-8d85-dce1974eb840.png#averageHue=%23e2a49d&clientId=uf2ee8ceb-c611-4&from=paste&height=585&id=u57eaab4b&originHeight=1170&originWidth=2102&originalType=binary&ratio=2&rotation=0&showTitle=false&size=188361&status=done&style=none&taskId=ub4b4198b-be06-4385-9679-42958ac3168&title=&width=1051)

## 前端环境搭建
已准备好，将nginx放到纯英文无空格目录下

## 后端环境搭建
### 熟悉项目结构
#### sky-pojo子模块：
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688698904759-88a2cf4e-827b-4fad-ba8b-32d09b5510c6.png#averageHue=%23f4edec&clientId=u8044adfc-0d9f-4&from=paste&height=563&id=u21022c06&originHeight=1125&originWidth=2574&originalType=binary&ratio=2&rotation=0&showTitle=false&size=642156&status=done&style=none&taskId=u5e03d923-004d-4ceb-b891-c5794e837de&title=&width=1287)

#### sky-server子模块：
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688698974280-590073bc-5b3e-4911-9b14-a319651929be.png#averageHue=%23fcfbfb&clientId=u8044adfc-0d9f-4&from=paste&height=645&id=u1b87c673&originHeight=1289&originWidth=2438&originalType=binary&ratio=2&rotation=0&showTitle=false&size=455708&status=done&style=none&taskId=u0b430b06-3cd9-48d8-9931-9b6e96fa6b0&title=&width=1219)

> ❓为什么从零开始搭建工程
> ✅进入公司开发，大部分从已有代码基础上继续开发业务开发


### 使用Git进行版本控制
#### Git概述
Git简介：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688701059068-90f95290-6de0-4cb6-ad67-3a0a9452808f.png#averageHue=%23f4f2f4&clientId=u8044adfc-0d9f-4&from=paste&height=226&id=u68adb16b&originHeight=452&originWidth=2806&originalType=binary&ratio=2&rotation=0&showTitle=false&size=333427&status=done&style=none&taskId=u21b634a7-47af-4095-8325-b4c5d70a3a6&title=&width=1403)

#### Git命令
[git - 简明指南](http://rogerdudler.github.io/git-guide/index.zh.html)

#### 版本控制
创建git仓库，选中当前目录文件<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688719056719-eae44276-64b0-45fa-b8ef-424b463116d3.png#averageHue=%23e5e4e4&clientId=u14fddbdc-4dc0-4&from=paste&height=462&id=ue9229ad4&originHeight=924&originWidth=1539&originalType=binary&ratio=2&rotation=0&showTitle=false&size=604170&status=done&style=none&taskId=udb5cacf6-1c56-4160-93c8-6bbd49a6fca&title=&width=769.5)

然后进行提交（commit）和推送（push）操作

### 数据库环境搭建
这部分不做重点说明，只需运行设计好的数据库的脚本

### 前后端联调

1. 首先使用maven对父模块进行complie 看看是否能运行
2. 再进行install 安装对应依赖和jar包（不太确定，而且可能可以直接install）
3. 启动项目，看是否能运行

-知识点模糊的点

- 全局自定义异常

![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688722030685-4b871f11-e2c7-4fa4-b410-d0dd7e1cd1bc.png#averageHue=%23f9efe7&clientId=u14fddbdc-4dc0-4&from=paste&height=293&id=ub372a50c&originHeight=447&originWidth=1024&originalType=binary&ratio=2&rotation=0&showTitle=false&size=204913&status=done&style=none&taskId=u53f0830f-919f-4bb8-bbee-8484437e209&title=&width=672)<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688722058712-de2c7dcc-4b9d-4754-afdb-ee06255ef71d.png#averageHue=%23f6f6f6&clientId=u14fddbdc-4dc0-4&from=paste&height=69&id=u5f5c80b1&originHeight=137&originWidth=545&originalType=binary&ratio=2&rotation=0&showTitle=false&size=28989&status=done&style=none&taskId=u83f64278-3dd4-4fc4-a3cd-0ba2f7ed71c&title=&width=272.5)

- JWT登录令牌

JWT（JSON Web Token）,以JSON传输信息<br />在登录时把信息放进Map里，然后基于Jwt编码（有对应工具类），返回前端对比<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688722377989-a8298bf6-0331-4d41-9763-ada8997f74f2.png#averageHue=%235f6948&clientId=u14fddbdc-4dc0-4&from=paste&height=302&id=u4b8682f3&originHeight=442&originWidth=535&originalType=binary&ratio=2&rotation=0&showTitle=false&size=224502&status=done&style=none&taskId=udce0e54f-83a1-4489-a89a-8c3f36e7762&title=&width=365.5)


#### nginx的反向代理和负载均衡：
反向代理：将前端发送的动态请求由nginx转发到后端服务器<br />负载均衡：将大量请求按照指定方式均匀分配给集群的服务器<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688728045861-5ee014c3-d2f4-40a3-bbe6-408f1691900d.png#averageHue=%23f8f5f5&clientId=u14fddbdc-4dc0-4&from=paste&height=765&id=u31d9ee6f&originHeight=1530&originWidth=2321&originalType=binary&ratio=2&rotation=0&showTitle=false&size=844556&status=done&style=none&taskId=u9bc24a59-f6d4-4c33-b5c0-f98c2772fc2&title=&width=1160.5)

#### nginx的配置方式
反向代理：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688728297622-53a4de46-3c53-4745-9fc5-d22cbd60595e.png#averageHue=%23f9f5e9&clientId=u14fddbdc-4dc0-4&from=paste&height=612&id=u738a28b6&originHeight=1224&originWidth=2762&originalType=binary&ratio=2&rotation=0&showTitle=false&size=647458&status=done&style=none&taskId=u829bcf50-634e-4c73-a4fb-3cbebaca9ae&title=&width=1381)

负债均衡：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688728396207-cf55ca57-aa28-4567-a341-36c9b19cfea3.png#averageHue=%23f9f5dc&clientId=u14fddbdc-4dc0-4&from=paste&height=619&id=ueecfc5d0&originHeight=1237&originWidth=2344&originalType=binary&ratio=2&rotation=0&showTitle=false&size=424826&status=done&style=none&taskId=uc3adf184-56b7-4002-b342-6e1d0f57405&title=&width=1172)

策略：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688728523451-3756f1ef-6c48-4ccb-8ff0-fb37e621fdd5.png#averageHue=%23e1c5c2&clientId=u14fddbdc-4dc0-4&from=paste&height=371&id=u731e37bd&originHeight=742&originWidth=2085&originalType=binary&ratio=2&rotation=0&showTitle=false&size=621173&status=done&style=none&taskId=ubae642b8-fa3d-4ec0-ae37-3f61acea1eb&title=&width=1042.5)

## 完善登录功能
问题：员工表的密码明文存储，安全性低<br />解决：使用MD5加密

步骤：

- 修改数据库的密码为MD5加密后的密文
- 修改Java代码，比对MD5加密后的密文

`password = DigestUtils.md5DigestAsHex(password.getBytes());`

# 导入接口文档
由于时间关系，直接导入接口文档（实际开发中，导入接口文档是漫长的讨论过程）

前后端分离开发流程：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688823788470-46eb4f73-43ee-4b7c-b2d8-ea1dc0b04267.png#averageHue=%23f9f9f9&clientId=uc823ea53-c701-4&from=paste&height=385&id=uc1d8958c&originHeight=1045&originWidth=1873&originalType=binary&ratio=2&rotation=0&showTitle=false&size=309772&status=done&style=none&taskId=ud93df677-253c-40c2-88b2-7d3af717836&title=&width=690)

# Swagger
## 介绍和使用方式
Swagger：只需按照规范定义接口，就能生成接口文档以及**在线接口调试**<br />Knife4j：为Java MVC框架集成Swagger生成Api文档的增强解决方案

Swagger以及Knife4j使用：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688825520040-e1b05679-1ebe-45fb-929c-64e5ff0495bb.png#averageHue=%23f6f1e1&clientId=uc823ea53-c701-4&from=paste&height=739&id=u7071f3f1&originHeight=1478&originWidth=2615&originalType=binary&ratio=2&rotation=0&showTitle=false&size=1261875&status=done&style=none&taskId=udecd4fc1-5a6a-418a-9cd3-710f554fd13&title=&width=1307.5)<br />在`http://localhost:8080/doc.html`中查看接口文档以及调试界面

## 常用注解
为了有更好的**可读性**，有以下常见注解：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688874253499-72f035ee-1357-4f3a-a87e-9e3297f7d79a.png#averageHue=%23fafbf7&clientId=u3c395a99-b0a0-4&from=paste&height=156&id=ucc1e3011&originHeight=311&originWidth=1480&originalType=binary&ratio=2&rotation=0&showTitle=false&size=198807&status=done&style=none&taskId=u04490077-7212-421c-9108-493a6be610a&title=&width=740)

加上之后，在接口文档中就会显示对应的注解信息，方便阅读，以达到**提高可读性目的。**

在对应类上：（类上用ApiModel、成员变量用ApiModelProperty）<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688873926251-4e833444-75b5-434c-8d54-39a50a08a232.png#averageHue=%23faf5f3&clientId=u3c395a99-b0a0-4&from=paste&height=401&id=u5b0c79fe&originHeight=801&originWidth=914&originalType=binary&ratio=2&rotation=0&showTitle=false&size=312860&status=done&style=none&taskId=ua52e3580-80cb-40b9-82b2-99f39d22b75&title=&width=457)

在controller方法层：（controller层上用Api、方法上用ApiOperation）<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688874035175-387a37d0-0e7e-4db6-9bd0-4825514ea939.png#averageHue=%23fbf4f2&clientId=u3c395a99-b0a0-4&from=paste&height=439&id=u865b2d68&originHeight=878&originWidth=1537&originalType=binary&ratio=2&rotation=0&showTitle=false&size=417250&status=done&style=none&taskId=ub0b9757e-849a-4f6e-8276-312ae59f8ab&title=&width=768.5)

# 员工管理、分类管理
## 员工管理
### 新增员工
#### 需求分析和设计
##### 产品原型：
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688826566485-62de65f9-626e-40b1-b8c8-62424f09c67a.png#averageHue=%23f9f9f9&clientId=uc823ea53-c701-4&from=paste&height=320&id=u4901a097&originHeight=1263&originWidth=2200&originalType=binary&ratio=2&rotation=0&showTitle=false&size=366382&status=done&style=none&taskId=u6bca0b54-62f8-4d98-ace2-15506025b1b&title=&width=558)

##### 接口设计：
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688826718393-24427914-2ae8-4f43-9e51-213b5a724f93.png#averageHue=%23faf7f6&clientId=uc823ea53-c701-4&from=paste&height=358&id=uf1b546b6&originHeight=1277&originWidth=2633&originalType=binary&ratio=2&rotation=0&showTitle=false&size=697764&status=done&style=none&taskId=ue956e72d-89e7-4abf-89eb-973f786b5a1&title=&width=738)

数据库设计：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688826794524-69e5c713-646f-4b69-80d2-908381135b0f.png#averageHue=%23f7eeed&clientId=uc823ea53-c701-4&from=paste&height=391&id=ub7d55e3d&originHeight=1283&originWidth=2052&originalType=binary&ratio=2&rotation=0&showTitle=false&size=345749&status=done&style=none&taskId=u8e2ed385-c965-4f9e-8202-f7b5b140815&title=&width=626)

#### 代码开发：
在controller层接收请求，service层将DTO对象拷贝进对象并补充剩余属性，最后在Mapper层插入进数据库
##### 遇到问题：先前用了Maven的complie，导致代码有缓存，只能重头来过。maven原理是什么？应该如何不重头来、消除缓存实时更新？（试过clean，但找不到Application应用程序类）

##### 疑问：为什么不用employee做@RequestBody对象呢，大不了后面插入数据库再设置参数。JavaWeb里好像就这么做
#### 功能测试：
测试时，由于jwt令牌检验，需要在登录时记录token，并在接口文档设置全局参数token

##### 注意：数据库插入元素时，#{}里要写类里对应属性名。（注意为了方便复制数据库名称）

#### 代码完善：

1. 录入用户名已存在时，抛出异常后没有处理
2. 新增员工时，创造人id和修改人id设置了固定值

动态设置操作人id：<br />Jwt认证流程：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688986036822-9bb1af12-2207-44a2-8c8e-3809d9266f2d.png#averageHue=%23363330&clientId=ud1cec1f4-96b2-4&from=paste&height=570&id=ube690c04&originHeight=1140&originWidth=1547&originalType=binary&ratio=2&rotation=0&showTitle=false&size=521932&status=done&style=none&taskId=uac1890ed-1973-493b-8d95-0d4b27739ba&title=&width=773.5)<br />引出问题：解析出登录员工id后，如何传递给Service的save方法？<br />相关技术：**TreadLocal**<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1688986168704-e32ef27e-00d8-4c5f-b901-a233e2e66e12.png#averageHue=%23f2ecec&clientId=ud1cec1f4-96b2-4&from=paste&height=154&id=u85a3ee7e&originHeight=308&originWidth=2894&originalType=binary&ratio=2&rotation=0&showTitle=false&size=186039&status=done&style=none&taskId=u90d6f6b9-966b-4027-8123-fc39b7b865c&title=&width=1447)<br />在jwt中使用TreadLocal临时保存id，然后在service层里从线程中取值

### 员工分页查询
#### 需求分析和设计
##### 产品原型：思考如何进行接口设计
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689240272674-2687c0f0-c473-4dd4-8549-0770bf87c3d9.png#averageHue=%23fafafa&clientId=ueb1d43b9-9b23-4&from=paste&height=259&id=u8e372648&originHeight=1238&originWidth=2963&originalType=binary&ratio=2&rotation=0&showTitle=false&size=489242&status=done&style=none&taskId=u03ffbc56-ba5a-4c11-9c07-e0228ea4a82&title=&width=620)

##### 接口设计：注意基本信息（接口映射以及请求方法）、请求参数（接口传参）、返回数据（接口返回值：数据类型设置）
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689240432544-22386fc2-8ad0-409d-81e5-f949bc6d508d.png#averageHue=%23fcf9f9&clientId=ueb1d43b9-9b23-4&from=paste&height=372&id=u956fadc2&originHeight=1496&originWidth=2486&originalType=binary&ratio=2&rotation=0&showTitle=false&size=653798&status=done&style=none&taskId=uc5bc96bf-73cd-46e0-917a-69d233346ee&title=&width=619)

#### 代码开发
对象类型：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689240677802-db10c902-5937-4ed3-84c6-f06115e27ea4.png#averageHue=%23faf9f9&clientId=ueb1d43b9-9b23-4&from=paste&height=432&id=u3e94cb62&originHeight=1255&originWidth=1596&originalType=binary&ratio=2&rotation=0&showTitle=false&size=378561&status=done&style=none&taskId=ue262b467-f353-49fb-a95e-7b5bfe2ef72&title=&width=549)

PageHelper插件：（JavaWeb课上笔记）<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689325962211-8a4a92a6-96c1-4efd-8e30-3ec3fbda67b4.png#averageHue=%23faf2ee&clientId=ud6231bcf-eb7a-4&from=paste&height=340&id=u1ade05ef&originHeight=968&originWidth=2144&originalType=binary&ratio=2&rotation=0&showTitle=false&size=1111611&status=done&style=none&taskId=ubf6e73c9-f16e-4368-83d5-fa1c91bc73e&title=&width=752)<br />_**底层原理：PageHelper底层依赖mybatis拦截器实现，把sql语句进行动态计算与拼接。**_<br />_**在startPage时，底层代码把传进来的page与pageSize用ThreadLocal传进来，在编写sql语句时动态传进去。**_<br />_**因此，startPage与后面查询方法就连起来了。**_

#### 功能测试：操作时间格式需要优化
接口文档调试<br />前后端联调<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689327983990-9b81c272-4d12-47f6-abc6-a1e3ec8dd822.png#averageHue=%23fbf9f7&clientId=ud6231bcf-eb7a-4&from=paste&height=363&id=u3ddc89d7&originHeight=725&originWidth=2635&originalType=binary&ratio=2&rotation=0&showTitle=false&size=81151&status=done&style=none&taskId=uc8afa88a-da31-4ec7-96b4-0c45384ea37&title=&width=1317.5)

#### 代码完善：
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689328188164-6920d3e9-73a5-4bad-9128-c50c2ca84697.png#averageHue=%23f7f4e3&clientId=ud6231bcf-eb7a-4&from=paste&height=622&id=u85681109&originHeight=1243&originWidth=2583&originalType=binary&ratio=2&rotation=0&showTitle=false&size=913458&status=done&style=none&taskId=ud90aca3f-6c0a-48e0-95f8-8b8528c6fa3&title=&width=1291.5)

方式一：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689328286210-9ca2b19a-7480-4f12-a8b5-fd30a01988db.png#averageHue=%23f4f2e6&clientId=ud6231bcf-eb7a-4&from=paste&height=83&id=uf6fe7fcd&originHeight=165&originWidth=1102&originalType=binary&ratio=2&rotation=0&showTitle=false&size=91366&status=done&style=none&taskId=uf0f03ab3-f6bd-4646-8227-e2651646976&title=&width=551)

方式二：<br />在继承了WebMvcConfigurationSupport的配置类中，重写方法，消息转化对象：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689335054189-8b5f76bf-9cda-417f-8943-4bb5c89144a5.png#averageHue=%23518738&clientId=ud6231bcf-eb7a-4&from=paste&height=330&id=u392162e6&originHeight=883&originWidth=1926&originalType=binary&ratio=2&rotation=0&showTitle=false&size=1022854&status=done&style=none&taskId=ub4f9a713-a3b0-4f32-aa11-52bca13e40b&title=&width=719)

效果图：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689335158660-f8b47668-fc40-46ed-8566-f9c86ea12fbb.png#averageHue=%23fbfbfb&clientId=ud6231bcf-eb7a-4&from=paste&height=206&id=ucb7ce75f&originHeight=411&originWidth=2589&originalType=binary&ratio=2&rotation=0&showTitle=false&size=57814&status=done&style=none&taskId=uf204e44a-364e-4da2-8226-f5301528769&title=&width=1294.5)

### 启用禁用员工账号
#### 需求分析与设计
##### 产品原型：
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689335390921-c57d2ff3-c6a8-41d2-b9ea-7fc14c5a8695.png#averageHue=%23f8f7f7&clientId=ud6231bcf-eb7a-4&from=paste&height=631&id=ueda53437&originHeight=1261&originWidth=2417&originalType=binary&ratio=2&rotation=0&showTitle=false&size=681184&status=done&style=none&taskId=u7a2d1011-a905-4832-b90f-736cdef3ec7&title=&width=1208.5)

##### 业务规则：
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689335418360-466b4555-c277-418d-8d38-52865ebfa865.png#averageHue=%23f0f0f0&clientId=ud6231bcf-eb7a-4&from=paste&height=245&id=ua1c5036a&originHeight=489&originWidth=1346&originalType=binary&ratio=2&rotation=0&showTitle=false&size=180872&status=done&style=none&taskId=ua5cad2ce-4ca9-4c57-aa08-4d5334bb0fb&title=&width=673)

##### 接口设计：
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689335499376-7831d9b8-c71e-495e-bf1d-197ead765104.png#averageHue=%23fdfdfc&clientId=ud6231bcf-eb7a-4&from=paste&height=660&id=u3cfe1e26&originHeight=1319&originWidth=2423&originalType=binary&ratio=2&rotation=0&showTitle=false&size=472399&status=done&style=none&taskId=uab583822-9580-4957-8a64-80294c7e010&title=&width=1211.5)

#### 代码开发：
根据开发接口文档，写出controller层响应请求：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689340501839-67deed61-0668-411a-9bc7-f965c7f57db3.png#averageHue=%234c423f&clientId=ud6231bcf-eb7a-4&from=paste&height=223&id=u51a25134&originHeight=445&originWidth=1474&originalType=binary&ratio=2&rotation=0&showTitle=false&size=365879&status=done&style=none&taskId=u9ed0c41b-4078-47ed-9a13-98509aa6f03&title=&width=737)<br />在service层，可直接将参数传入mapper层，但此处为了后续遍历，创造了一个通用的update方法在mapper层。因此service层将两个数据封装。<br />（❗❗❗**_此处体现代码能少写就少写的重要习惯，减少复用代码！！！_**）<br />而封装另一种代码风格可以使用builder加入参数（前提是类上有@build标签），当然直接new来set也行。

最后在mapper层，使用多个if判断对对应值进行赋值，完成update方法。

### 编辑员工
较为简单，思路：需求分析后为两个方法，一个是根据id查询信息并回写到前端，另一个是根据传来的信息传到mapper层中修改

体会：

- 当result需要返回时，确定返回的类型是什么，填写在泛型中。若只对数据修改不涉及返回，则直接使用result。（_**疑问：能不能都用result，需要返回也可以在sucess()方法里填类型？**_）
- 此处体现了“启用禁用员工账号”时编写update的妙处，体会到减少代码复用的魅力。在第二个方法中直接使用之前的update方法。


## 分类管理
与“员工管理”业务逻辑类似，都是对数据库增删改查后映射到前端，因此省略<br />具体实现业务：<br />新增分类、分类分页查询、删除分类、修改分类、启用禁用分类、根据类型查询分类、


### 公共字段自动填充
涉及之前模糊的知识点：**面向切面编程**
#### 问题分析与实现思路
问题：每次在插入和更新都要更改以下信息<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689566964622-fdaa9e58-6c89-46ed-ae3e-ddde8ca03be3.png#averageHue=%23e6e4d0&clientId=u861306db-8469-4&from=paste&height=588&id=u8091033c&originHeight=1175&originWidth=2730&originalType=binary&ratio=2&rotation=0&showTitle=false&size=1036897&status=done&style=none&taskId=u6bbf69ea-c6a8-4413-a905-c4ed28d90c2&title=&width=1365)

实现思路：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689567091890-e60fbc4f-8db4-4503-873f-ea6a3d1a998c.png#averageHue=%23f2e1e0&clientId=u861306db-8469-4&from=paste&height=648&id=ua9a3968e&originHeight=1296&originWidth=2709&originalType=binary&ratio=2&rotation=0&showTitle=false&size=712951&status=done&style=none&taskId=u6a0fbc7c-fbc0-45ba-add6-e1ff1903f2c&title=&width=1354.5)

#### 代码开发

1. 自定义AutoFill，标识需要进行填充的方法（配置 Target 和 Retention）

![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689585092581-5a41e66d-7ab4-4b31-8a50-ab864581fd83.png#averageHue=%23fbe6e3&clientId=u861306db-8469-4&from=paste&height=246&id=u4e2f4138&originHeight=492&originWidth=789&originalType=binary&ratio=2&rotation=0&showTitle=false&size=204328&status=done&style=none&taskId=uef3bbca0-920a-4ea7-9029-b6a5acbeade&title=&width=394.5)

2. 自定义切面类AutoFillAspect，利用反射为公共字段赋值
   1. 自定义切面类(@Aspect @Component) @before括号中填写切入点(autoFillPointCut)

![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689587244383-11ec02bc-1436-4f5a-a212-cc6f97688ca7.png#averageHue=%23faeceb&clientId=u861306db-8469-4&from=paste&height=372&id=ucfc1c6e5&originHeight=744&originWidth=1423&originalType=binary&ratio=2&rotation=0&showTitle=false&size=403760&status=done&style=none&taskId=u0a8cd550-f1f2-4e8e-b730-9fd3aaac698&title=&width=711.5)

   2. 利用反射为公共字段赋值

![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689587213290-d4dd9757-93be-4ebc-920b-08b5c94e37ad.png#averageHue=%23fceeed&clientId=u861306db-8469-4&from=paste&height=489&id=u89d31020&originHeight=977&originWidth=1599&originalType=binary&ratio=2&rotation=0&showTitle=false&size=584948&status=done&style=none&taskId=ub01e0a9a-1ecc-46db-9913-c11a8fad2d4&title=&width=799.5)<br />**getDeclaredMethod**方法是无论其访问修饰符是什么,都能获取方法名。而**getMethod**则只能获取公共方法<br />注意：参数有两个（方法名，参数字节码）<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689591805807-42bcfb7a-49f0-4a71-a9a8-7ab825bc3720.png#averageHue=%23fbf2f2&clientId=u861306db-8469-4&from=paste&height=617&id=uf63d900d&originHeight=1234&originWidth=2068&originalType=binary&ratio=2&rotation=0&showTitle=false&size=997444&status=done&style=none&taskId=uc785926a-8017-46b9-b8d3-1d1a5db0b5a&title=&width=1034)

3. 在mapper上在关于特定方法中加入AutoFill注解（注意在注解内声明类型）

![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689586295370-1c971ef7-4001-4968-9c32-8741fa26f084.png#averageHue=%23fbf6f3&clientId=u861306db-8469-4&from=paste&height=156&id=u9532dd69&originHeight=312&originWidth=892&originalType=binary&ratio=2&rotation=0&showTitle=false&size=118917&status=done&style=none&taskId=u898e65a6-f56e-47df-a064-21acaa3fafa&title=&width=446)

# 菜品管理
## 新增菜品
### 图片上传
总体思路<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689736603988-6c320892-2c88-4b39-ad1f-ef6642a9f0d1.png#averageHue=%23fefefd&clientId=u28168dca-8390-4&from=paste&height=152&id=u9d345edd&originHeight=304&originWidth=2375&originalType=binary&ratio=2&rotation=0&showTitle=false&size=136744&status=done&style=none&taskId=u4cdcc2fc-2ef2-4de9-8260-3ae511a7e8e&title=&width=1187.5)<br />新建**属性配置类**，准备需要配置的属性，并用注解说明配置属性类（可自动赋值）；然后在**application-dev** 开发环境中设置对应参数，并在**application**中引用开发环境中的参数；<br />完成配置后使用所添加的参数编写**工具类方法**。调用则新建一个配置类**将工具类的属性进行赋值**，并且设置为Bean类（再加上只创建一个），使其能直接使用而不用在编程时传参。
#### 🔴配置类作用
配置类都是成员变量的

- 便于application中设置配置信息
- 调用配置类便于获取application中信息

配置类是一个方法 - 设置bean类 - 使用时可直接引用 配置类不用配置相关信息

配置：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689737034420-a75e6669-014b-43d0-aa37-f215332f650d.png#averageHue=%23fcefef&clientId=u28168dca-8390-4&from=paste&height=416&id=uf3709031&originHeight=832&originWidth=2016&originalType=binary&ratio=2&rotation=0&showTitle=false&size=629026&status=done&style=none&taskId=uc5ce574d-3302-448b-abe8-69304ba0ddd&title=&width=1008)

![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689737200529-157f9853-f12e-485b-acda-19ce3bbac1dc.png#averageHue=%23fbf4f2&clientId=u28168dca-8390-4&from=paste&height=419&id=u5ec39229&originHeight=838&originWidth=1162&originalType=binary&ratio=2&rotation=0&showTitle=false&size=362489&status=done&style=none&taskId=u5e99c336-0a8e-4408-9a76-37cd5744b84&title=&width=581)

配置工具类：生成Bean对象，导入数据<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689738991809-2786a620-ce60-48e6-8bb1-3ca8a639d003.png#averageHue=%23fbebe9&clientId=u28168dca-8390-4&from=paste&height=383&id=ud89d59c3&originHeight=766&originWidth=1561&originalType=binary&ratio=2&rotation=0&showTitle=false&size=597012&status=done&style=none&taskId=u315c8c24-d63d-44ca-ad46-46885f602d6&title=&width=780.5)

工具类功能：👆上面已经赋值，可直接新建AliOssUtil使用<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689739079261-d043a46d-5fa4-4601-890c-d8fdb96bf0ba.png#averageHue=%23fcf6f5&clientId=u28168dca-8390-4&from=paste&height=426&id=uf26922eb&originHeight=1318&originWidth=1693&originalType=binary&ratio=2&rotation=0&showTitle=false&size=544127&status=done&style=none&taskId=u1711a8cf-17df-4caf-b0d8-a588d58993d&title=&width=547)

接口：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1689757564753-b96eff85-5257-4fbe-88be-0e62f99464af.png#averageHue=%23fcf5f3&clientId=uc3357ba3-d5fa-4&from=paste&height=352&id=u5333b6a9&originHeight=1053&originWidth=1602&originalType=binary&ratio=2&rotation=0&showTitle=false&size=557612&status=done&style=none&taskId=ud8e42509-3e9d-4759-ab27-b8411ae745c&title=&width=535)

### 新增信息
在controller层使用DishDTO接收参数信息，调用service层逻辑处理。service层中在菜品表和口味表中插入对应信息（这里涉及多表操作，需要加@Transactional保证事务原子性 - SkyApplication也有enable），注意这里插入完菜品表后，需要在插入菜品表中留下id（@useGeneratedKeys和keyProperties），以便在口味表中设置。


### 分页查询
在controller层用DTO返回数据，注意返回值为Result<PageResult>，然后在service层中使用PageHelper插件进行分页，mapper层对所有字段进行判断（limit 由插件填写）


### 删除菜品
根据菜品id删除，mapper层：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1690276840096-8d8e94e4-189c-48dd-a2ef-4d5ee37d3a88.png#averageHue=%23f5f2f2&clientId=u61f44e2d-bdf8-4&from=paste&height=620&id=u4dd398a9&originHeight=1239&originWidth=2150&originalType=binary&ratio=2&rotation=0&showTitle=false&size=839281&status=done&style=none&taskId=u568e1f69-5f2b-45c7-87b4-1aeda6da88b&title=&width=1075)

service层的逻辑：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1690277028328-d1165cfa-a234-4400-993b-87d57e27d956.png#averageHue=%23efefef&clientId=u61f44e2d-bdf8-4&from=paste&height=242&id=uf11640c0&originHeight=483&originWidth=946&originalType=binary&ratio=2&rotation=0&showTitle=false&size=122085&status=done&style=none&taskId=u745aca64-e4bc-4a1c-92ac-76c264435a5&title=&width=473)

- 参数可以为多个（1，2，3，4） - 需要list收集
- service层判断菜品是否为起售状态
- 查询套餐表是否有关联菜品，如果有则不能删除
- 根据dishId删除口味数据

# 套餐管理
## 新增套餐
经验：

- 数据库中区分_和驼峰命名
- mapper层中如果传入的是list集合，需要在xml中使用foreach遍历元素，进行赋值
   - 其中，赋值需要填写 list.xxx 而不能直接填写xxx
- controller层中，如果传参是集合，需要添加注释@RequestParam

## 分页查询
注意：

- mapper层中需要修改什么，取决于传参传进了什么。而不是page接受的实体的全部属性
- 动态SQL中不要加；否则动态加入SQL后会报错
- 在<if>标签中记得每个条件都需要前面加and

## 更新套餐
### 为什么更新菜品的业务逻辑是先删除后添加?
因为修改的信息可能为空 可能不修改,可能减少或增多,因此update不好写条件,而采用先删除后添加的逻辑

## 经验：
在service层中不要想当然直接调用mapper层修改数据<br />要思考有没有业务逻辑 - 涉及多个数据库需要多表操作 某种情况下操作不允许等等<br />**service本来就是业务逻辑实现的地方**

# 店铺营业状态设置
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1690967813284-496dc116-fe49-4afe-8cf8-eb7fa5834a9b.png#averageHue=%23987836&clientId=u303536c6-7fa9-4&from=paste&height=653&id=u72ab352b&originHeight=1305&originWidth=2743&originalType=binary&ratio=2&rotation=0&showTitle=false&size=1271493&status=done&style=none&taskId=ub449696b-54a4-4615-b329-64deab6284b&title=&width=1371.5)

主要内容：

- Redis入门
- Redis数据类型
- Redis常用命令
- 在Java中操作Redis
- 店铺营业状态设置

## Redis入门
### Redis简介

### Redis数据类型
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1690969505079-7fd3d258-dcf2-4483-a0ec-8cb21374b462.png#averageHue=%23f9f9f9&clientId=u303536c6-7fa9-4&from=paste&height=384&id=u6e64a869&originHeight=767&originWidth=2068&originalType=binary&ratio=2&rotation=0&showTitle=false&size=165637&status=done&style=none&taskId=u214b9e11-ef33-4491-87e7-ce57ddbd662&title=&width=1034)

各个数据类型特点:<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1690970526878-7d6a15c4-3677-48c5-85a8-431332abba05.png#averageHue=%23f4f4f4&clientId=u303536c6-7fa9-4&from=paste&height=645&id=u4e8def11&originHeight=1290&originWidth=2888&originalType=binary&ratio=2&rotation=0&showTitle=false&size=760074&status=done&style=none&taskId=u09ec0d23-0c91-4019-bcd3-b584c8917da&title=&width=1444)

## 常见命令
### 字符串操作命令
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1690970752952-7fc87438-7533-4a6b-b848-bd593ac222b2.png#averageHue=%23f5f5f5&clientId=u303536c6-7fa9-4&from=paste&height=309&id=u9be1edd3&originHeight=618&originWidth=2398&originalType=binary&ratio=2&rotation=0&showTitle=false&size=253692&status=done&style=none&taskId=u5ebe7c2d-bf64-484f-9024-19d63f0a804&title=&width=1199)

### 哈希操作命令
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1690971368014-c5f4f6ea-8f47-43bb-b72b-bba0ea30f8de.png#averageHue=%23f5f5f5&clientId=u303536c6-7fa9-4&from=paste&height=354&id=ue58b3ad6&originHeight=707&originWidth=1484&originalType=binary&ratio=2&rotation=0&showTitle=false&size=257069&status=done&style=none&taskId=u60cda12a-920c-4939-b9a2-4f19b45c2f1&title=&width=742)

### 列表操作命令
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1690971458759-b20e0ea4-2dbb-4e42-bdaa-cd0aeefaccee.png#averageHue=%23f4f4f4&clientId=u303536c6-7fa9-4&from=paste&height=452&id=u74eb14a5&originHeight=904&originWidth=1487&originalType=binary&ratio=2&rotation=0&showTitle=false&size=288633&status=done&style=none&taskId=u01fe3511-4a30-4271-8693-465275f2499&title=&width=743.5)

### 集合操作命令
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1690971207846-f8ccd759-54cc-421a-9ec1-83f0e3f196ca.png#averageHue=%23f3f3f3&clientId=u303536c6-7fa9-4&from=paste&height=442&id=ue95d44be&originHeight=884&originWidth=2314&originalType=binary&ratio=2&rotation=0&showTitle=false&size=462325&status=done&style=none&taskId=u3cfa4e94-fa86-422f-a469-65f9736a811&title=&width=1157)

### 有序集合操作命令
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1690971984024-4632d70d-0d43-4f71-95c2-7d162e787b95.png#averageHue=%23f5f5f5&clientId=u303536c6-7fa9-4&from=paste&height=604&id=udfa058e6&originHeight=1208&originWidth=2804&originalType=binary&ratio=2&rotation=0&showTitle=false&size=625996&status=done&style=none&taskId=u91589d96-20eb-4876-a98e-6397d407c79&title=&width=1402)

### 通用命令
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1690985019236-c02d7d35-f8bb-440b-99c9-a9d3211ae55f.png#averageHue=%23f2f2f2&clientId=udb7cb6f9-5fb2-4&from=paste&height=340&id=ua1133168&originHeight=679&originWidth=1733&originalType=binary&ratio=2&rotation=0&showTitle=false&size=239007&status=done&style=none&taskId=u3ec72339-c518-44a4-9999-7ddac016f22&title=&width=866.5)

## 用Java中操作Redis
简介 - 方式：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1690985185287-ad1f1438-9935-41ed-b72c-5f1ee75e85af.png#averageHue=%23f6f6f6&clientId=udb7cb6f9-5fb2-4&from=paste&height=377&id=u92aafa18&originHeight=754&originWidth=1781&originalType=binary&ratio=2&rotation=0&showTitle=false&size=201147&status=done&style=none&taskId=u51114667-f839-41af-b413-8150b03e1b0&title=&width=890.5)

### 环境搭建
使用方式：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1690985296059-640dc5b7-63f2-418e-a5ad-c4c13ea21c12.png#averageHue=%23f8f7eb&clientId=udb7cb6f9-5fb2-4&from=paste&height=635&id=u012db732&originHeight=1270&originWidth=2726&originalType=binary&ratio=2&rotation=0&showTitle=false&size=834156&status=done&style=none&taskId=u930428d6-bff5-40fa-9ad0-ac42348981f&title=&width=1363)

②在配置文件中配置 - 注意点：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1690986627555-87625a41-dc8b-4d96-935d-63055ac47873.png#averageHue=%23f7f3e9&clientId=udb7cb6f9-5fb2-4&from=paste&height=153&id=u1c4d1dd1&originHeight=305&originWidth=1175&originalType=binary&ratio=2&rotation=0&showTitle=false&size=175472&status=done&style=none&taskId=ue9175dfb-7d18-4ea0-8601-d14be5dae7a&title=&width=587.5)

③编写配置类：<br />**RedisTemplate为spring框架的类属性 需要传参RedisConnectionFactory 用于连接Redis**<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1690986659780-2ca38743-cd76-419e-844d-baec942a84a0.png#averageHue=%2362643b&clientId=udb7cb6f9-5fb2-4&from=paste&height=446&id=uc7d2b2df&originHeight=891&originWidth=1931&originalType=binary&ratio=2&rotation=0&showTitle=false&size=1036774&status=done&style=none&taskId=u563bf723-436a-4abc-b555-d459e4f553f&title=&width=965.5)<br />RedisTemplate需要设置Redis的连接工厂 - Spring Data Redis会自己创建RedisConnectionFactory放到spring容器中

④通过RedisTemplate即可使用Redis

### 获取值
用RedisTemplate获取值：<br />获取对象<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1690986339366-068bbf6b-7113-45a3-b578-8f0baf0a9562.png#averageHue=%23484b4e&clientId=udb7cb6f9-5fb2-4&from=paste&height=332&id=PTZ1T&originHeight=663&originWidth=1255&originalType=binary&ratio=2&rotation=0&showTitle=false&size=228405&status=done&style=none&taskId=uda255c17-bb11-4b3d-8909-d044001cead&title=&width=627.5)<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1690987163690-02a449e3-da38-40e6-9527-efab46aec026.png#averageHue=%234e453e&clientId=udb7cb6f9-5fb2-4&from=paste&height=467&id=u436bddb4&originHeight=933&originWidth=1525&originalType=binary&ratio=2&rotation=0&showTitle=false&size=789336&status=done&style=none&taskId=u7924a401-3671-4524-ae35-515ed3ac76a&title=&width=762.5)

哈希：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691073042300-d8c30a1f-dc2f-4b88-a5c1-2bd0534f8c74.png#averageHue=%23faf9f6&clientId=u2c360ec9-9eae-4&from=paste&height=556&id=u42f040cd&originHeight=1112&originWidth=1857&originalType=binary&ratio=2&rotation=0&showTitle=false&size=607238&status=done&style=none&taskId=u470b4cb2-29f6-42cd-88a6-3ef73c6ec7f&title=&width=928.5)

列表：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691073401057-b15139e1-5924-4c36-b7d7-62986b3555df.png#averageHue=%23f9f8f5&clientId=u2c360ec9-9eae-4&from=paste&height=549&id=u4c832b36&originHeight=1098&originWidth=1616&originalType=binary&ratio=2&rotation=0&showTitle=false&size=544262&status=done&style=none&taskId=u7b6f095e-bae1-42d6-9f4d-1429e3428a4&title=&width=808)

有序集合：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691073606668-506f6e64-eacc-4361-9f64-3435f08d9ed3.png#averageHue=%23f9f8f5&clientId=u2c360ec9-9eae-4&from=paste&height=519&id=u513481fa&originHeight=1038&originWidth=1555&originalType=binary&ratio=2&rotation=0&showTitle=false&size=574619&status=done&style=none&taskId=ue8197698-1451-4a1e-b733-4f87a51310e&title=&width=777.5)

通用命令：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691073879598-a87629bb-e9c1-4096-b54e-ab62d8705f2e.png#averageHue=%23faf9f6&clientId=u2c360ec9-9eae-4&from=paste&height=523&id=uce8676c9&originHeight=1046&originWidth=1483&originalType=binary&ratio=2&rotation=0&showTitle=false&size=419251&status=done&style=none&taskId=uea7842a1-a43f-4bdb-9aba-a1264cf71a3&title=&width=741.5)

## 店铺营业状态设置
### 需求分析与设计
#### 产品原型
需要两个接口：一个查询状态显示到页面（这里分了管理端和用户端 需要两个接口），一个管理端的修改状态
#### 接口设计
（路径 ）- 请求 - 请求参数 - 返回数据 （"接口闪电" - 在代码中呈现闪电⚡状）<br />GET（查询） 与 PUT（修改）请求。<br />查询不需要传参，返回data 1 or 0 表示状态即可<br />请求需要接收参数，修改状态。返回成功失败即可

status如何储存？单独在MySQL中创建一个表？太浪费空间了<br />**使用Redis**   status为key-value结构

### 代码开发

### 功能测试
把controller分成admin与user<br />swagger接口文档也要分成两个docker了


# 微信小程序开发
## HttpClient
### 介绍
> HttpClient 是Apache Jakarta Common 下的子项目，可以用来提供高效的、最新的、功能丰富的支持 HTTP 协议的**客户端**编程工具包，并且它支持 HTTP 协议最新的版本和建议。

发送请求步骤

- 创建HttpClient对象
- 创建Http请求（Get Post）对象
- 调用HttpClient的execute方法发送请求

### 发送GET请求
测试代码：（跑测试前需要把项目启动 - 才能访问地址路径）<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691079954710-4c38c168-47d0-4c4f-9594-dcd439e5138c.png#averageHue=%23fcfcfa&clientId=u2c360ec9-9eae-4&from=paste&height=574&id=u7247f404&originHeight=1147&originWidth=1428&originalType=binary&ratio=2&rotation=0&showTitle=false&size=527818&status=done&style=none&taskId=u46764b91-a222-4f2f-8148-7a55ae70901&title=&width=714)

### 发送POST请求
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691169159417-2a68ada0-650d-4bb0-84e5-1c93dd4e186b.png#averageHue=%23fcfcfb&clientId=u8dabfdf5-b327-4&from=paste&height=486&id=u69b1191e&originHeight=972&originWidth=1435&originalType=binary&ratio=2&rotation=0&showTitle=false&size=481407&status=done&style=none&taskId=u956453a4-96c7-4ade-870c-2da50059785&title=&width=717.5)<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691169187689-fbdd17de-0c62-43bf-b513-5b732f2510b4.png#averageHue=%23fbfaf8&clientId=u8dabfdf5-b327-4&from=paste&height=295&id=u05d99cc4&originHeight=589&originWidth=1032&originalType=binary&ratio=2&rotation=0&showTitle=false&size=240428&status=done&style=none&taskId=u6f0f030b-3e79-4384-bee1-fa7c508d6d1&title=&width=516)

## 小程序准备
步骤：

- 注册小程序
- 完善小程序信息
- 下载开发者工具

## 入门案例
步骤：

- 了解小程序目录结构
- 编写小程序代码
- 编译小程序

### 了解小程序目录结构
整体程序**app**：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691251359243-3f9142b1-9407-47b2-8267-d7e15c39082b.png#averageHue=%23e0e0e0&clientId=u9c543b46-bf50-4&from=paste&height=528&id=u4ba5af27&originHeight=1056&originWidth=2511&originalType=binary&ratio=2&rotation=0&showTitle=false&size=492169&status=done&style=none&taskId=uebe10890-29dc-4ea9-ab78-0aa0edb98a8&title=&width=1255.5)

页面**page**：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691251469913-543caf43-1ebe-424f-98b5-31184f66e054.png#averageHue=%23dedddc&clientId=u9c543b46-bf50-4&from=paste&height=527&id=u363ab34e&originHeight=1053&originWidth=2481&originalType=binary&ratio=2&rotation=0&showTitle=false&size=408367&status=done&style=none&taskId=ua5ebb80e-cd8b-45c1-84bb-fa79ff01241&title=&width=1240.5)<br />wxss类似CSS文件



## 小程序
### 商城浏览
#### 需求分析与设计
产品原型：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691683145515-a7e2a4fb-22c4-43e5-a1d8-c544b8d37f87.png#averageHue=%23c9c5bc&clientId=u24b9df67-6309-4&from=paste&height=656&id=ub74e3edc&originHeight=1312&originWidth=2950&originalType=binary&ratio=2&rotation=0&showTitle=false&size=1637698&status=done&style=none&taskId=u8bd673d0-b104-4c54-9e1a-023d3f2eb5c&title=&width=1475)

接口设计：

- 查询分类
- 根据分类id查询菜品（一共关联菜品口味）
- 根据分类id查询套餐
- 根据套餐id查询包含菜品

## 微信登陆
微信小程序请求需要返回token Id openId <br />（其中重头是openId Id需要根据传来参数请求接口 获取user用户信息对象来获取）<br />token则运用以上信息使用jwtUtil生成
### 配置参数
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691772435105-eb332300-65c4-4cca-9584-a6e4858cb1d3.png#averageHue=%234d6045&clientId=u009769dd-8953-4&from=paste&height=428&id=u761c3c6a&originHeight=856&originWidth=916&originalType=binary&ratio=2&rotation=0&showTitle=false&size=474230&status=done&style=none&taskId=u15e38c92-dfc9-4c17-bedf-d2a45f3afe2&title=&width=458)<br />👆当然上面信息配置一个配置类：

1. 方便编写application
2. 方便调用application信息

### 代码开发
查看[微信开发文档中登录](https://developers.weixin.qq.com/miniprogram/dev/OpenApiDoc/user-login/code2Session.html)的文档<br />传入参数用DTO接收，返回VO<br />小程序发出请求附带参数code - 使用code获取user用户信息
> code传入Service层，使用code以及已有其他信息去**发送请求给微信登录接口**（在文档中有说明）得到openId
> 得到openId后在Mapper层查询user对象并将其返回。如果查不到则插入user对象后返回。

获取用户信息后生成jwt令牌 - 使用jwt工具类 - 生成token<br />openId和id根据user的get方法出来即可


### 🎇经验：
建议完备自己的工具类（jwtUtil、fastJSON、HttpClient）

## 缓存菜品
> 与操作系统内存管理（希望没记错 ）类似

问题引入：当用户量大起来时...<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691897543175-c273d8c2-b4da-4dcb-886d-f118a83e0869.png#averageHue=%23f6f4f3&clientId=uff7811cf-ceb7-4&from=paste&height=596&id=ud831d2e3&originHeight=1192&originWidth=2626&originalType=binary&ratio=2&rotation=0&showTitle=false&size=669104&status=done&style=none&taskId=udd92b207-41de-4a5f-8807-23bd3a71e22&title=&width=1313)

实现思路：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691900157778-e2499700-43ee-404f-8d2a-7144169a6d3e.png#averageHue=%23fdfdfd&clientId=uff7811cf-ceb7-4&from=paste&height=571&id=u913ae0de&originHeight=1142&originWidth=2895&originalType=binary&ratio=2&rotation=0&showTitle=false&size=314537&status=done&style=none&taskId=u8a096744-1f28-4eb0-8470-71032c69a75&title=&width=1447.5)<br />逻辑分析：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691900305633-bf6742a1-105a-460e-bef7-4c10c20e9fb5.png#averageHue=%23eeebe8&clientId=uff7811cf-ceb7-4&from=paste&height=615&id=u5c6b0d19&originHeight=1229&originWidth=2291&originalType=binary&ratio=2&rotation=0&showTitle=false&size=784512&status=done&style=none&taskId=ucf5971b1-59ca-4d3d-8e53-68c88a3f827&title=&width=1145.5)

### 缓存数据
用户每次查询就在Redis中将其分类的菜品缓存<br />实现：<br />定位：用户查询根据分类id查菜品 - UserDishController - 对应的方法<br />逻辑：判断菜品是否被缓存：用Redis根据约定好的“dish_x”查询数据

- 如果有则直接返回直接返回
- 如果没有 - 则按照查询数据库得出数据将他保存到Redis中，返回数据

![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691919332595-e5ee324a-1b11-4344-81ec-270c1920850c.png#averageHue=%234c433c&clientId=uff7811cf-ceb7-4&from=paste&height=655&id=u5b45a161&originHeight=1310&originWidth=1529&originalType=binary&ratio=2&rotation=0&showTitle=false&size=1168769&status=done&style=none&taskId=uec8f2485-2b9e-490f-b3cc-d0b72a8d5ae&title=&width=764.5)

### 删除数据
管理员对菜品进行新增、修改、删除、菜品启用与停用需要删除缓存，以**保证数据一致性**<br />实现：<br />定位：管理员对菜品进行操作 - AdminDishController - 对应方法<br />逻辑：由于查数据库寻找精准分类id得不偿失，因此需要查询数据库的精准删除都进行**删除全部缓存操作**<br />新增：传入的DTO可以直接获取菜品信息，因此根据分类id精准删除分类<br />修改、删除、启用：都需要查询数据库 - 删除全部缓存


![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691919303442-d6bfe8ca-deab-410a-9692-059d822704a0.png#averageHue=%235d6e3d&clientId=uff7811cf-ceb7-4&from=paste&height=553&id=u2c7df49b&originHeight=1105&originWidth=1650&originalType=binary&ratio=2&rotation=0&showTitle=false&size=1014984&status=done&style=none&taskId=uf4b70e5e-0368-4dfe-903c-e91e1402057&title=&width=825)


## Spring Cache - 基于注解的缓存功能
### 介绍
使用方式：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691919427711-a3dcc8b9-fb39-4db1-a96c-df1da02ecc2d.png#averageHue=%23f7f7ee&clientId=uff7811cf-ceb7-4&from=paste&height=524&id=u584e53b0&originHeight=1047&originWidth=2627&originalType=binary&ratio=2&rotation=0&showTitle=false&size=484757&status=done&style=none&taskId=u1110d5d4-36ad-472a-bdee-f045bccccee&title=&width=1313.5)

常用注解：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691920341067-795c4874-1b01-4ef8-b9fa-e40eb17cbac1.png#averageHue=%23bbc7db&clientId=uff7811cf-ceb7-4&from=paste&height=288&id=ud46037ed&originHeight=576&originWidth=2588&originalType=binary&ratio=2&rotation=0&showTitle=false&size=504473&status=done&style=none&taskId=u764b13e6-d2d7-4ad6-83f7-99bcec91aa8&title=&width=1294)

### @CachePut 
使用：cacheNames 为文件夹，key为键名（符号：：在Redis中会生成一个entity文件夹） - 看第一行注释<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691921008503-d0664854-b7bd-488f-b1dd-6d1ecb077eb9.png#averageHue=%23f3f0e5&clientId=uff7811cf-ceb7-4&from=paste&height=262&id=uace8a82d&originHeight=524&originWidth=1864&originalType=binary&ratio=2&rotation=0&showTitle=false&size=366333&status=done&style=none&taskId=uec98cb30-0090-4b12-ba8f-3b0389ee68c&title=&width=932)

### @Cacheable
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691921909737-504de6bb-e56d-46b6-8b08-7fa7bc4f0990.png#averageHue=%23f5f2e4&clientId=uff7811cf-ceb7-4&from=paste&height=162&id=uee9de82b&originHeight=323&originWidth=1377&originalType=binary&ratio=2&rotation=0&showTitle=false&size=145593&status=done&style=none&taskId=u6c7dceeb-a50e-4a28-b720-f344921285b&title=&width=688.5)<br />原理：该注解会为该类生成代理对象，来查询Redis是否有存储，有则直接返回，没有则通过反射调用此方法并存储到Redis中

### @CacheEvict
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1691945220971-4cc91f72-846d-4fb7-bae7-6fc2ff8015a7.png#averageHue=%23fcfaf8&clientId=u668158aa-5e4f-4&from=paste&height=288&id=u5cdda273&originHeight=576&originWidth=1427&originalType=binary&ratio=2&rotation=0&showTitle=false&size=287715&status=done&style=none&taskId=u6acd5b2d-8496-40e9-8450-01f4e5d4f5d&title=&width=713.5)<br />原理：通过代理对象动态的计算id，然后删除id对应的值

### 代码开发
实现思路：以套餐接口为例<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692002716564-12e5c293-bd2a-40f9-b951-b300368e16cd.png#averageHue=%23f4f3f3&clientId=u41710156-327a-4&from=paste&height=292&id=u693780aa&originHeight=584&originWidth=2516&originalType=binary&ratio=2&rotation=0&showTitle=false&size=366478&status=done&style=none&taskId=u6b66709b-3722-42e4-b27a-64493780534&title=&width=1258)

## 添加购物车
### 需求分析
产品原型 - 接口文档：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692006197857-2d135a99-fc6f-4ff0-96ef-3e39b752e930.png#averageHue=%23c8c3bb&clientId=u41710156-327a-4&from=paste&height=557&id=u7492dd72&originHeight=1114&originWidth=2269&originalType=binary&ratio=2&rotation=0&showTitle=false&size=996450&status=done&style=none&taskId=u81934fe6-6e86-4c56-a38c-e282b06e313&title=&width=1134.5)

数据库表设计：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692006360077-e245af36-a5b3-4d65-969c-dc5143f0e489.png#averageHue=%23f2f2f2&clientId=u41710156-327a-4&from=paste&height=315&id=u1877bc09&originHeight=629&originWidth=874&originalType=binary&ratio=2&rotation=0&showTitle=false&size=114332&status=done&style=none&taskId=ube9dd826-4eea-4efc-a240-e712afd3dea&title=&width=437)

- 选什么商品：菜品id和套餐id其中一个
- 每个商品都买几个：商品数量
- 不同用户的购物车区分开：用户id
- 单价、商品名称、图片（冗余字段 - 通过其他可以查出的字段 - **为什么要设置：提高查询速度 **- 需要较固定的字符，只能适量使用）

### 代码开发
重点在Service层的业务逻辑：

- 首先查询数据库中购物车信息 + dish_id or setmeal_id (flavorId)
   - 如果有信息，则在原来数量基础上+1
   - 如果没信息，判断加的是菜品还是套餐
      - 获取传参的属性值设置到ShoppingCart中
      - 最后插入数据到数据库中

### 功能测试
细致，把业务逻辑中考虑的每一步都测试到

## 查看购物车
### 需求分析
产品原型：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692020863154-d152c100-9420-42c4-8e97-5ebdb2149dd2.png#averageHue=%23cfcbc4&clientId=u41710156-327a-4&from=paste&height=486&id=u1312a9a6&originHeight=1288&originWidth=889&originalType=binary&ratio=2&rotation=0&showTitle=false&size=401597&status=done&style=none&taskId=uc5457711-2d54-4e59-b2b8-6699380c117&title=&width=335.5)

### 代码开发
简单查表返回，注意传参使用TreadLocal获取用户id

## 清空购物车
简单删除数据，条件是userId


## 地址
产品原型：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692022532930-aa64406c-9719-4b71-86b2-4db8ba06c314.png#averageHue=%23ece9e2&clientId=u41710156-327a-4&from=paste&height=623&id=u6c68c33c&originHeight=1245&originWidth=2640&originalType=binary&ratio=2&rotation=0&showTitle=false&size=347618&status=done&style=none&taskId=u0c16e008-8bf8-4c49-9ec5-9abe9cdabee&title=&width=1320)

### 代码导入

## 用户下单
### 需求分析与设计
接口设计：<br />分析：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692101492671-159b773c-beb9-4eaf-9c6e-66ce09c0ae24.png#averageHue=%23efeeed&clientId=u29cce7e3-f140-4&from=paste&height=449&id=ua86261b4&originHeight=1239&originWidth=1405&originalType=binary&ratio=2&rotation=0&showTitle=false&size=337688&status=done&style=none&taskId=u055d3efb-78ac-4b31-9bd3-291e464e5e0&title=&width=509.5)![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692101604153-d5a22e90-5822-4c75-a9b0-37aba5188280.png#averageHue=%23efeee9&clientId=u29cce7e3-f140-4&from=paste&height=513&id=uc50540b9&originHeight=1277&originWidth=1256&originalType=binary&ratio=2&rotation=0&showTitle=false&size=198802&status=done&style=none&taskId=uc1328e58-c93b-4642-ab5b-ae126d87243&title=&width=505)

成品：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692101659447-b381beaa-088a-4908-ad7d-0c435f248dba.png#averageHue=%23fdfdfd&clientId=u29cce7e3-f140-4&from=paste&height=608&id=uf5ebe9f6&originHeight=1216&originWidth=2918&originalType=binary&ratio=2&rotation=0&showTitle=false&size=638952&status=done&style=none&taskId=u2b41f53a-fca7-4de7-a63e-a9d9b058037&title=&width=1459)

### 数据库设计
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692111262174-de262935-acb0-4875-8acd-e941b35ad07a.png#averageHue=%23fafafa&clientId=ua7b87403-bac0-4&from=paste&height=426&id=ube3765b9&originHeight=1315&originWidth=1784&originalType=binary&ratio=2&rotation=0&showTitle=false&size=176278&status=done&style=none&taskId=uaf345499-d6b4-48b1-924b-f09940dd985&title=&width=578)<br />成品：<br />订单表：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692111304167-24fad1e4-207b-42ef-91d2-4291b6ebd0eb.png#averageHue=%23f5f1f1&clientId=ua7b87403-bac0-4&from=paste&height=596&id=u3ecdb103&originHeight=1191&originWidth=2957&originalType=binary&ratio=2&rotation=0&showTitle=false&size=451574&status=done&style=none&taskId=u7be7f440-33ca-4172-b7df-ab70f390422&title=&width=1478.5)

订单明细表：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692111332611-60524c5a-6947-425f-98ba-290a25ad83f0.png#averageHue=%23f6eaea&clientId=ua7b87403-bac0-4&from=paste&height=639&id=uf2399fc1&originHeight=1277&originWidth=2256&originalType=binary&ratio=2&rotation=0&showTitle=false&size=254618&status=done&style=none&taskId=ucc0eee6c-6d70-418b-abf2-f286defc13e&title=&width=1128)

### 代码开发
设置DTO（接收传参）与VO（返回）<br />业务逻辑:

1. 判断业务异常:(地址簿为空,用户购物车无数据)
2. 插入一条订单数据
3. 插入n条订单明细数据
4. 清空购物车
5. 封装返回VO

注意：当业务层涉及多次操作数据库时，为了保持数据一致性，需要添加注解Transactional回滚事务，操作原子化

## 微信支付
### 介绍
分类：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692195867898-6208317f-4dc5-42f5-91bc-1bbe8feb4d4a.png#averageHue=%23fcfcfc&clientId=u05e3f33f-a35b-4&from=paste&height=608&id=u5b24d6b4&originHeight=1215&originWidth=2202&originalType=binary&ratio=2&rotation=0&showTitle=false&size=280359&status=done&style=none&taskId=u1b22a8b2-e42f-4550-831b-772f779a2d2&title=&width=1101)

时序图：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692196330647-e2376fcf-9d3c-4cdd-8337-835d5a83d92e.png#averageHue=%23f9f9f9&clientId=u05e3f33f-a35b-4&from=paste&height=531&id=u4a82f3ca&originHeight=1062&originWidth=1477&originalType=binary&ratio=2&rotation=0&showTitle=false&size=270227&status=done&style=none&taskId=u26658ed5-d794-410a-b094-7aadb20cb48&title=&width=738.5)

### 接口介绍
预支付交易单：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692196580860-0de71f4a-d2bc-4c0c-a4ee-411a0935be6e.png#averageHue=%23d0bbb4&clientId=u05e3f33f-a35b-4&from=paste&height=625&id=ub9afcb0c&originHeight=1249&originWidth=2918&originalType=binary&ratio=2&rotation=0&showTitle=false&size=826531&status=done&style=none&taskId=u771d1821-cc2f-46a9-82d8-1f51bb5490c&title=&width=1459)

调起支付：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692196649089-d5f9360a-c066-48d9-84af-77ae2d66ad21.png#averageHue=%23c9ccc0&clientId=u05e3f33f-a35b-4&from=paste&height=642&id=uf7cc64c6&originHeight=1283&originWidth=2895&originalType=binary&ratio=2&rotation=0&showTitle=false&size=660480&status=done&style=none&taskId=u2f38da91-653d-4d30-b2f2-f80993748f9&title=&width=1447.5)

### 准备工作
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692196814926-5226e751-0fcc-4614-9812-fe523d4bba93.png#averageHue=%23f8f8f8&clientId=u05e3f33f-a35b-4&from=paste&height=632&id=ube0e1f01&originHeight=1263&originWidth=1956&originalType=binary&ratio=2&rotation=0&showTitle=false&size=355844&status=done&style=none&taskId=u8124121b-9253-4fdc-9652-cf96b8041f1&title=&width=978)


## Spring Task 定时任务
### 介绍
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692364330870-5ec397ef-2b1d-47ac-9528-9f9f04e3a042.png#averageHue=%23cccac9&clientId=u934ceea7-1e2b-4&from=paste&height=611&id=u3f87dfa7&originHeight=1222&originWidth=2824&originalType=binary&ratio=2&rotation=0&showTitle=false&size=838496&status=done&style=none&taskId=u5381ff23-3900-4a52-94b0-fd6b878bb15&title=&width=1412)

应用场景：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692364389016-de3f805d-2d02-4fb6-97b1-77cb8b3adedf.png#averageHue=%23f7eedc&clientId=u934ceea7-1e2b-4&from=paste&height=639&id=ua41398fa&originHeight=1277&originWidth=2436&originalType=binary&ratio=2&rotation=0&showTitle=false&size=791913&status=done&style=none&taskId=u21d94689-2248-4395-9f25-5206fa4f9b2&title=&width=1218)

### cron表达式
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692364658267-d21cc606-37d3-4021-bc4b-cf7e13dffdc1.png#averageHue=%23f6f5f5&clientId=u934ceea7-1e2b-4&from=paste&height=557&id=uf622ec57&originHeight=1114&originWidth=2073&originalType=binary&ratio=2&rotation=0&showTitle=false&size=417635&status=done&style=none&taskId=ue18ef91f-1649-4451-83dc-d9ded096932&title=&width=1036.5)

可以利用以下工具：<br />[在线Cron表达式生成器](https://cron.qqe2.com/)<br />[在线Cron表达式生成器](https://cron.qqe2.com/)

### 入门案例
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692365170970-63657fe0-ed80-480d-a133-e9abfbf8770d.png#averageHue=%23f9f9f8&clientId=u934ceea7-1e2b-4&from=paste&height=423&id=u38ec9999&originHeight=845&originWidth=2546&originalType=binary&ratio=2&rotation=0&showTitle=false&size=320302&status=done&style=none&taskId=u817fa9e4-4072-4857-9563-d73494efe1c&title=&width=1273)<br />主要关注：eron表达式 以及 方法内的操作

### 订单状态定时处理
需求分析：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692365466596-6e84386b-0cc9-46a0-be13-07e0989fc003.png#averageHue=%23f4f4f4&clientId=u934ceea7-1e2b-4&from=paste&height=509&id=u9f788ee3&originHeight=1017&originWidth=2894&originalType=binary&ratio=2&rotation=0&showTitle=false&size=555262&status=done&style=none&taskId=uda78db44-2c89-44bd-bb9a-9e7e9368621&title=&width=1447)


## WebSocket
### 介绍
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692371410007-c17fd1c7-2626-4a9b-a7f8-42cf60df651a.png#averageHue=%23ddaf78&clientId=u934ceea7-1e2b-4&from=paste&height=645&id=uf9ee5e5a&originHeight=1290&originWidth=2824&originalType=binary&ratio=2&rotation=0&showTitle=false&size=943050&status=done&style=none&taskId=u72a328c3-74f5-416e-b09b-4a8ca8dacfb&title=&width=1412)

实际应用：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692371428582-2da41e85-2b43-407a-8bb6-b9ce6cf4dc3b.png#averageHue=%23f4f3e9&clientId=u934ceea7-1e2b-4&from=paste&height=617&id=uff3fc2ec&originHeight=1234&originWidth=2938&originalType=binary&ratio=2&rotation=0&showTitle=false&size=1708281&status=done&style=none&taskId=ub1275a48-7b0f-4ca7-99ef-f8ef03920ea&title=&width=1469)


### 来单提醒：
#### 需求分析与设计
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692373498174-a368e7fb-de53-443e-aa4e-0c5efcfefb74.png#averageHue=%23f3f3f3&clientId=u934ceea7-1e2b-4&from=paste&height=499&id=u5a7081db&originHeight=998&originWidth=2495&originalType=binary&ratio=2&rotation=0&showTitle=false&size=491207&status=done&style=none&taskId=ud6e9dd83-d4c5-4df0-9b94-b58056ca1ae&title=&width=1247.5)

#### 代码开发：
客户端和服务端握手原理：（**为什么没有访问到idea服务端中tomcat的8080端口就能建立连接呢？**）<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692373717517-77e23a9c-3d05-4b10-b68b-3311017e5207.png#averageHue=%23e5e0d7&clientId=u934ceea7-1e2b-4&from=paste&height=186&id=u75106a91&originHeight=372&originWidth=2192&originalType=binary&ratio=2&rotation=0&showTitle=false&size=319609&status=done&style=none&taskId=u9c747ec1-43b6-4ea2-9ba2-2a4a934759c&title=&width=1096)

准备工作:

- 准备WebSocketServer类
- 准备WebSocketConfiguration配置类(设置bean类)

配置好后启动服务端,管理端有以下响应:<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692375202654-107b9251-b7fc-4dfe-8525-43b35436a659.png#averageHue=%23272b30&clientId=u934ceea7-1e2b-4&from=paste&height=620&id=ufe9958c7&originHeight=1240&originWidth=3200&originalType=binary&ratio=2&rotation=0&showTitle=false&size=329541&status=done&style=none&taskId=u67612947-967c-4b55-8a40-00e6afc0e74&title=&width=1600)

> 由于没有实现微信支付功能，而来电提醒的逻辑是在微信支付成功后由WebSocketServer发出给管理端，因此暂时不能实现。


### 客户催单:
#### 需求分析
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692375440216-3cba96d7-da9d-48c6-92f0-1c26fece0524.png#averageHue=%23f3f3f3&clientId=u934ceea7-1e2b-4&from=paste&height=490&id=u730f711b&originHeight=980&originWidth=2493&originalType=binary&ratio=2&rotation=0&showTitle=false&size=284649&status=done&style=none&taskId=ub9418b00-0813-4c0e-ba84-1cebd966061&title=&width=1246.5)<br />催单需要用户点击,因此需要发送请求.催单传参为订单id<br />代码开发只需调用Service层,在service层中用id查询订单相关信息用于获取订单号.封装类型 id 以及订单号发送给WebSocketServer给管理端发送信息.<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692376842069-6295cb6c-6032-46f9-b61c-ec1a49393bc1.png#averageHue=%235d783f&clientId=u934ceea7-1e2b-4&from=paste&height=469&id=u4f761349&originHeight=938&originWidth=1580&originalType=binary&ratio=2&rotation=0&showTitle=false&size=797226&status=done&style=none&taskId=u40ad42d1-0dc2-41a7-99a4-a6fe03d7ba1&title=&width=790)

## Apache ECharts
### 介绍
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692376690348-3a07f590-6d43-4c11-9533-0e964fd6eabc.png#averageHue=%23fbfafa&clientId=u934ceea7-1e2b-4&from=paste&height=619&id=u69c32446&originHeight=1237&originWidth=2813&originalType=binary&ratio=2&rotation=0&showTitle=false&size=315566&status=done&style=none&taskId=uafd44fc6-333b-4e94-90b6-496c82060fc&title=&width=1406.5)

### 营业额统计
需求分析：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692458562824-a2717f0a-c8c0-473b-9200-a1a87e7fec69.png#averageHue=%23fafafa&clientId=u9f731367-26d0-4&from=paste&height=639&id=ued01840c&originHeight=1277&originWidth=1910&originalType=binary&ratio=2&rotation=0&showTitle=false&size=204534&status=done&style=none&taskId=ud5216aa6-3589-479c-9cda-88965aa0065&title=&width=955)

接口设计<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692458767255-ab300540-3eec-4092-b002-7dd7cab47904.png#averageHue=%23fcfbfb&clientId=u9f731367-26d0-4&from=paste&height=526&id=ub26f252c&originHeight=1051&originWidth=2672&originalType=binary&ratio=2&rotation=0&showTitle=false&size=290168&status=done&style=none&taskId=u28a0afd8-b4ea-45c0-9f48-e0786c55d0c&title=&width=1336)

#### 代码开发：
##### ❗注意：![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692525848375-036b1775-2d7e-4b84-abfd-aa863acd394d.png#averageHue=%23454b3e&clientId=uf35c5ff2-f5dd-4&from=paste&height=481&id=u7bf60c74&originHeight=961&originWidth=1415&originalType=binary&ratio=2&rotation=0&showTitle=false&size=632541&status=done&style=none&taskId=uc8f3d3d2-3f33-4bee-b30b-1daa8f5dbbb&title=&width=707.5)
**在xml写SQL语句时，大于小于号需要转义字符。否则无法识别**

### 用户统计
#### 产品原型：
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692526124617-453251ab-02b8-4bd3-891a-8ae10402a2fa.png#averageHue=%23fbfbfb&clientId=uf35c5ff2-f5dd-4&from=paste&height=650&id=uce8e7c82&originHeight=1299&originWidth=2067&originalType=binary&ratio=2&rotation=0&showTitle=false&size=358802&status=done&style=none&taskId=ue68e29f1-452e-4110-91c6-89477cfe813&title=&width=1033.5)

#### 接口设计：
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692526160733-49e1a802-8e8f-49c4-9d8b-2e35f4d325a4.png#averageHue=%23fcfcfc&clientId=uf35c5ff2-f5dd-4&from=paste&height=479&id=u41441694&originHeight=957&originWidth=2527&originalType=binary&ratio=2&rotation=0&showTitle=false&size=470770&status=done&style=none&taskId=u2e85e198-5562-4158-90fd-11ade24d608&title=&width=1263.5)

### 订单统计
#### 需求分析
产品原型<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692539066317-75e5ca49-3fd8-4f55-a0bc-72f037061683.png#averageHue=%23fafafa&clientId=ub79147e4-d20a-4&from=paste&height=653&id=u55be79dd&originHeight=1306&originWidth=1997&originalType=binary&ratio=2&rotation=0&showTitle=false&size=448272&status=done&style=none&taskId=ue4ecb858-3b09-4ed9-a76c-041eec42a9c&title=&width=998.5)

接口设计：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692539171720-2b863c71-f87f-45fa-8225-db72118dbe99.png#averageHue=%23fcfcfc&clientId=ub79147e4-d20a-4&from=paste&height=530&id=udaa57508&originHeight=1060&originWidth=2721&originalType=binary&ratio=2&rotation=0&showTitle=false&size=626992&status=done&style=none&taskId=u610a3b06-e11e-4f83-a5ec-38c7eadf8e3&title=&width=1360.5)

### 销量排名统计
#### 需求分析
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692541803258-05584d10-0cd7-4dc1-b335-42d4e9fc833d.png#averageHue=%23f9f9f9&clientId=ub79147e4-d20a-4&from=paste&height=645&id=uc215234d&originHeight=1290&originWidth=1540&originalType=binary&ratio=2&rotation=0&showTitle=false&size=161936&status=done&style=none&taskId=ub9c37b8d-a6e8-420f-b589-cfe5d066bf2&title=&width=770)

接口设计：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692541857863-b1a85e62-60bd-42f7-ad67-fa382084cc31.png#averageHue=%23fcfcfc&clientId=ub79147e4-d20a-4&from=paste&height=482&id=u4059f735&originHeight=964&originWidth=2504&originalType=binary&ratio=2&rotation=0&showTitle=false&size=228196&status=done&style=none&taskId=u5b79d660-2a22-4585-8433-8955cafef4c&title=&width=1252)

## 工作台
### 需求分析
 产品原型：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692545961053-b321f490-109e-43e2-b157-9814db2620b4.png#averageHue=%23e2e2e2&clientId=ub79147e4-d20a-4&from=paste&height=651&id=u580d03df&originHeight=1301&originWidth=2714&originalType=binary&ratio=2&rotation=0&showTitle=false&size=500351&status=done&style=none&taskId=ub33aa31f-4638-4d6b-bd92-d2534197d06&title=&width=1357)

### 名词解释
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692545978384-f3d9c8da-8ecb-4f35-853c-de3ef2795260.png#averageHue=%23f0f0f0&clientId=ub79147e4-d20a-4&from=paste&height=372&id=u63cebc52&originHeight=743&originWidth=1126&originalType=binary&ratio=2&rotation=0&showTitle=false&size=214079&status=done&style=none&taskId=u7f8bb415-12bd-4acc-8b2d-b3aae2bf783&title=&width=563)

### 接口设计
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692546052093-44158aee-bb17-4859-8897-fc943886686c.png#averageHue=%23e0dbda&clientId=ub79147e4-d20a-4&from=paste&height=654&id=u0270897e&originHeight=1307&originWidth=2975&originalType=binary&ratio=2&rotation=0&showTitle=false&size=577851&status=done&style=none&taskId=uc20703af-5645-4e7f-950d-f2cee260c88&title=&width=1487.5)

接口详情见YAPI

### 代码导入

## Apache POI
### 介绍
### ![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692548783636-a5d3d4bb-9629-4ae6-b4be-39740753449c.png#averageHue=%23f8f8f8&clientId=ub79147e4-d20a-4&from=paste&height=413&id=u92181b9a&originHeight=826&originWidth=2772&originalType=binary&ratio=2&rotation=0&showTitle=false&size=306817&status=done&style=none&taskId=u45f2343d-fe99-45c2-bc60-13ccfb60956&title=&width=1386)

应用场景：<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692548838101-7b00970c-84bb-4c17-9666-71d62438490f.png#averageHue=%23f1f1f1&clientId=ub79147e4-d20a-4&from=paste&height=576&id=uadf6c75d&originHeight=1151&originWidth=2858&originalType=binary&ratio=2&rotation=0&showTitle=false&size=354380&status=done&style=none&taskId=u40a18436-f4db-46f0-b1b5-9a9e5bfffd4&title=&width=1429)


### 入门案例：
写操作：代码很直观：创建文件 - 创建sheet页 - 定位行 - 在行中写信息 - 输出流将文件写出<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692624460669-cc5f3ff4-01de-4b33-8881-82cff6794b5a.png#averageHue=%23fbfbfa&clientId=u1360d1b8-7929-4&from=paste&height=597&id=u6e5b2d6c&originHeight=1193&originWidth=1557&originalType=binary&ratio=2&rotation=0&showTitle=false&size=391967&status=done&style=none&taskId=u041ceb8c-617b-4f6f-8406-d2f2293e66d&title=&width=778.5)

### 导出运营数据业务
#### 需求分析
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692625094941-e4944763-0454-4cdf-8c8e-39427ab37390.png#averageHue=%23f9f8f5&clientId=u1360d1b8-7929-4&from=paste&height=660&id=uf974fa92&originHeight=1320&originWidth=2008&originalType=binary&ratio=2&rotation=0&showTitle=false&size=340310&status=done&style=none&taskId=ub40522b5-938b-4cac-ae41-639c3c99474&title=&width=1004)<br />只需要按照格式导出表格（即写出操作） 不需要返回操作，也不需要接收参数

#### 代码开发
按照表格开发 - 样式多样很复杂 - 代码开发样式繁杂 - **开发一般根据一个模板文件读取后在模板填写数据**

**步骤：**<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/35394687/1692625289936-a1935ce0-2241-4868-b2a6-b33e39c1cdc5.png#averageHue=%23f5f5f2&clientId=u1360d1b8-7929-4&from=paste&height=432&id=u971808ab&originHeight=864&originWidth=2592&originalType=binary&ratio=2&rotation=0&showTitle=false&size=582040&status=done&style=none&taskId=u1137ecf5-0327-4687-bbac-03ecb52fcae&title=&width=1296)

# 总结
常见业务逻辑：

- 数据库查询必要信息
- 异常情况判断
- 业务逻辑处理（修改状态  添加等）

在xml配置文件中写Mapper需要注意：

- 大于号 小于号 尽可能用转义字符，防止报错
   - &gt;  为 >    |    &lt;    为 <

#### 🔴配置类作用
配置类都是成员变量的

- 便于application中设置配置信息
- 调用配置类便于获取application中信息

配置类是一个方法 - 设置bean类 - 使用时可直接引用 配置类不用配置相关信息

建议：完善自己的工具类Util库，壮大武器库
